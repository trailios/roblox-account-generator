from src            import Log, Headers, Utils
from curl_cffi      import Session
from urllib.parse   import quote

def get_token(blob: str, session: Session) -> str | Exception:
    c = "to7gvP8PsEIO1/g8gU47O8bjIXTP/0nJSfIt4g==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"
    payload = "c=" + quote(c) + "&" \
    "public_key=A2A14B1D-1AF3-C791-9BBC-EE33CC7A0A6F&" \
    "site=https%3A%2F%2Fwww.roblox.com&" \
    "userbrowser=Mozilla%2F5.0%20(3795MB%3B%201440x2392%3B%20580x575%3B%20411x683%3B%20Samsung%20SM-G930F%3B%2013)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20%20ROBLOX%20Android%20App%202.706.750%20Phone%20Hybrid()%20%20GooglePlayStore%20RobloxApp%2F2.706.750%20(GlobalDist%3B%20GooglePlayStore)&capi_version=4.0.14&" \
    "capi_mode=inline&style_theme=Inline&" \
    "rnd=0.7340430014462593&" \
    "data[blob]=" + quote(blob) # b-but flagged! No shit thanks for letting me know.

    # we love arkoselabs

    response_arkoselabs = session.post(
        "https://arkoselabs.roblox.com/fc/gt2/public_key/A2A14B1D-1AF3-C791-9BBC-EE33CC7A0A6F", 
        data=payload, 
        headers={**Headers.ARKOSELABS_GT2, "x-ark-esync-value": Utils.short_esync()}
    )

    if "sup=1" in response_arkoselabs.json().get("token"):
        Log.info("Solved funcaptcha: " + response_arkoselabs.json().get("token").split("|")[0])
        return response_arkoselabs.json().get("token")
    
    else:
        raise Exception("Failed to solve funcaptcha: " + response_arkoselabs.json().get("token").split("|")[0])
    
    # just implement solver api, this was jsut for testing. But it does work. >:3